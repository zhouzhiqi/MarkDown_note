1，单元势函数 
单元势函数$A_i(y_i,\phi_i(x))$主要表示对于给定某种超像素块特征其类别y的条 
件概率分布，或者说当输入是xi而类别是y的置信度大小，而不考虑其他像素 
块的影响。不管是单元势函数或者成对势函数，其分类器或者说类别概率分布产 
生模型没有固定的形式，当然实际中为了计算方便会选择经典的分类器和模型， 
比如说成对势函数一般使用基于potts先验的上下文相关公式。

通常利用logistic分类器[59]来表示单元势函数，多类别logistic分类器能够 
根据输入信号输出具体毎种类别的概率分布即$\hat{y_i}=arg\ max_{y_i}p(y_i|\phi(x))$。用其 
作为CRF的单元势函数是很合理的，依据logistic分类的计算方法则单元势函 
数可以表示成如下式(3.4): 
$$(3.4)$$
式中区域特征向量$f_i(x)=[\phi_{i1},\phi_{i2},\dots,\phi_{iK},1]^T$，K表示为每个区域提取 
的总的特征长度大小，f(x)对应的向量权重$w=[w_1,w_2,\dots,w_K,\alpha_1]^T$，而且对应于 
每种类别分别有不同的w和偏置，其中$\alpha_1$表示的是偏置权重。我们能够发现当 
去掉成对势函数后，该CRF可退化成原始的多类别Logistic分类器计算方法。 
2，成对势函数 
CRF的成对势函数形如$I_{ij} \big(y_i, y_j, \mu(\phi_i(x),\phi_j(x))\big)$表示的是i和j超像素块之 
间的影响和类别传递关系，当然具体权重可能设定成与实际的像素块特征距离有 
关，还有的与像素块索引的空间距离有关，一般是距离越远影响会变小，对于向 
量差距的影响也符合上述原理。现在实际应用过程中一般利用统计物理学中的 
potts模型，其与MRF关键的不同之处在于块i和块j不一定要求是相邻接的， 
即便是距离很远也会被考虑在内，该式的参数用来调节类别约束的各分量权重， 
参数一般是由监督训练得到，该方法的对数形式的公式如下式(3.5)： 
$$(3.5) $$

式中$v=[v_1,v_2,\dots,v_L]^T$对应于差分向量的每个分量的权值，当然最后一个分 
量是偏差项的权值。$\mu_{ij}(x) $一般选取为超像素块特征向量$x_i和x_j$的差分，而且最 
后一项附带1，即$\mu_{ij}=\left[ |\phi_i(x)-\phi_j(x)|,\ 1\right]^T$。 

成对势函数$\sigma_{y_i y_j}(v^T\mu_{ij}(x))$根据类别标号$y_i和y_k$的相同与不同会取截取不同 
的块特征向量$\mu_{ij}(x)$的部分参与计算，成对势函数不单单取决于特征向量的差分， 
实际上i，j处的类别标签对计算也有影响，如果类别标签一样的话会忽略向量的 
绝对差值，只计算偏差项部分，如果不一样的话，那么将忽略偏差项，将会考虑 
权重和对应的向量差分，仍然进行向量内积操作，分开来看的话，偏差项的大小 
反映相邻区域属于同一类别的可能性加成，一般来说邻接区域的类别相同的可能 
性强于不邻接区域。类别标号不一致一般反映区域属于不同物体，故存在特征向 
量分布的不连续性，该式可以反映邻接区域会出现不同类别的先验概率的强度， 
具体数值与两区域块的特征向量距离有关，一般向量之间的空间差距很大的话， 
说明这两个区域块属于不同标签的置信度很大，这样的话会给邻接区域设定不同 
类别时带来正比于特征向量差距的惩罚。 

我们知道CRF需要样本来训练模型的参数，而且知道模型的参数后需要找 
到最适合输入样本X的标签分布。一般来说，CRF的参数估计仍然基于极大似 
然的原理，运用L-BFGS算法[60]来优化参数使得符合该样本的类别标注的概率为 
最大，应用梯度下降法来一步步收敛使参数达到最佳。CRF推理就是在给定参 
数下，求得最适合该样本的类别标注，即给定样本后分配各个区域的类别以使得 
条件概率最大，为了减少运算次数，通常有MAP[61]和LBP[62]等方法，通过这些 
方法可以显著降低运算次数，使问题解决变成可能。 

3.1.2像素块特征提取 
对于基于超像素块区域的特征提取要考虑到区域的内部均质性，提取的特征 
应该反映区域的整体性质而与区域大小形状无关，对于SA民图像meanshift得到 
的超像素块我们可以提取强度特征，纹理特征以及符合相关特性的的极化分解特 
征。 
1，强度特征 
强度特征主要反映区域内像素点色度的分布规律和整体特性，最简单的如均 
值，方差等都是基于每个像素点色度值的计算。 
(1)灰度直方图 
多极化SAR数据由hh，hV，Vh，VV四种极化方式构成，hV和Vh是 
对称的关系，如果仅用一种通道很多区域就会无法分辨，故目前最好的是采取 
hh， hV，VVh通道数据，对每个通道的数据映射到0到255之间形成灰度图 
像，将256阶的灰度分成16段区间，针对每个区域计算该区域的像素分布，并 
根据灰度映射到对应的区间，这样我们可以得到灰度直方图，将每个区间的数量 
最终除w该区域总的像素点数得到归一化的概率分布，可以得到16维度的归一 
化概率分布特征，16个维度的值之和为1。 
口)hAAr特征 
hAAr特征是基于不同矩形框内像素的强度值之和的差异来计算的，图3.2显 
示了 hAAr特征使用的矩形框位置特征模板。首先图像中有白色和黑色的区域， 
而且对应于某一中也点的矩形框需要设定合适的大小，然后需要分别统计白色区 
域和黑色区域像素点灰度么和，接着将白色区域灰度之和减去黑色区域灰度之和， 
最后将其除w矩形框的总的像素灰度之和进行归一化操作，这样就得到了某一模 
板的hAAr特征，一共有屯个模板。之后再针对每个像素块执行均值操作即可， 
每个区域可以得到7个维度特征。 
3国田田田田gh 
hAAr－h
 hAAr－V
 hAAr－d hAAr－tl hAAr－tr hAAr－Bl hAAr－B 巧 
图3.2 hAAr特征模板 
22 
2，纹理特征 
纹理特征一般选择多种滤波器多种尺度扫描图像得到，之后在每个超像素 
块取均值即可，传统的滤波器包括髙斯滤波器，X或y方向衍生高斯滤波器，拉 
普拉斯滤波器等，针对SAR伪彩色图像的特征提取，有人组合了 17个滤波器组 
{＾得到17维度的纹理特征向量取得了很好的效果。 
3，极化分解特征 
SAR雷达通过多极化的方法得到的数据一般是2X2的矩阵63张式，该矩阵 
的值主要因为雷达发射信号呈现水平和垂直两种方向的波，雷达接收天线也是呈 
现水平和垂直的方向故有四种极化波，包含hV， hh， Vh， VV这四个数值， 
该矩阵反映了目标物体的相位特性，散射特性，矩阵的值都是复数形式，故具有 
幅度和相位信息，目标不同的结构和本身的后向散射特性如介电常数，表面渗透 
率以及雷达和物体的空间朝向，相对位置等都会导致矩阵各值的不同。 
在选定的正交极化基(w，n下，雷达的发射电磁波矢量去f和接收电磁波矢 
量去＊可以分别表示为： 
玄巧之＊ ＋巧＾
 (3.6) 
育＝巧—卽＋巧一e，
 (3.7) 
左f和左k的关系可以表示为； 
－
刮片h Sw「巧
＿皆＿｜— r uw SJiX」
 t 
式(3.8)中，r为散射目标与接收天线么间的距离，Ad为电磁波波数。极 
化散射矩阵S表示为式(3.9)： 
；叫
 (3.9) 
其中Sw和Sw表示同极化分量，在互易条件下，Sw＝Sw，表示交叉极化 
分量。 
Pauli分解[u诣在正交线性基下，用Pauli基对地物目标的散射矩阵进行的分 
解。Pauli基包括四个参数{[S。]，[S＊]，口。]，[＆]}，具体形式如下 
剧＝诚：]，[w ＝走[；句 0.w 
23  
閒二去[：江防]＝去[：〇＇ 
根据相干分解的原理，散射矩阵[S]可以表示为： 
[小「产訂＝。闷＋化]＋啦]＋啦] 口.11) 
当测量系统为单基系统，且满足互易定理时，即＝ 散射矩阵分解 
为： 
[巧＝「子＂；叫＝4＆] ＋啦]＋ 化]
 (3.12) 
＿
＾Vh
 ＿ 
式(3.12)中｜冲表示单次散射的能量，忡表示具有二面角散射特性的散射 
体的能量，｜c｜2表示具有倾斜45°二面角散射特性的散射体的能量。此外还有Sdh 
分解和huynen分解等特征分解方法，在此不多介绍。 
3.2基于后置CRF的deeplab模型 
3.2.1 de巧lAB 的 CRF 结构 
低级别的图像处理任务比如图像分割或图像深度评估经常需要对每个点分 
配类别标签。针对于单个像素点类别分类的特征提取是一个很重要的课题和任务。 
同样的考虑一些重要因素比如图像边缘，空间连续性，表象连续性的影响来分配 
类别会使结果更加精确。 
设计出一个强大的像素级特征表达对于点的分类至关重要，(＾＞1往的方法如纹 
理森林，随机森林效果一般。由于最近的监督式深度学习方法如CNN在髙级图 
像识别和检测上得到广泛应用，所1＾ FCN被设计用来使CNN可｜＾＞1对每个像素点 
分类。无数的基于CNN的分类器在像素级分类任务上效果显著，然而，对于FCN 
用于像素级分类也有很多缺点。首先，传统的FCN卷积层的卷积核有极大的感 
受野，因此对于单个像素点有着极大的模糊输出，对于单像素点分类是很大的误 
差来源。此外，pooling层的降维功能也对点的分类产生极大干扰。因此很多FCN 
结果产生的分割结果会出现模糊不规则的边缘和块状的分割区域。第二，FCN 
缺少平滑约束，该约束有利于使分割结果趋向于相似的像素，空间与表象的连续 
分布。没有平滑约束会导致分割结果中错误的物体边缘和虚假的微小区域。 
24 
概率图模型在各种场合的应用己被证实可有效提高分类正确率。MRF和 
CRF在诸多信号分类领域都表现出极强的分类辨别能力，尤其是图像分类与分 
割中。图像分割的CRF推理中的关键因素就是将类别标号问题转变成概率推理 
问题，其中考虑到如周围相似像素点的促进作用。CRF可以将模糊和不盈著的 
像素级类别标注提取成锐利的边缘分布和细腻的分割结果。因此，CRF可以用 
来解决FCN中模糊输出而产生分类误差的问题，FCN—般依靠梯度下降算法来训 
练，一般上将CRF作为后置心]的处理加在FCN的结果上来改菩分割的结果， 
deeplab是此种方式的典范。 
假设X，代表点i的类别标签，具有l种类别。假设X是：c，到：c。形成的向量， 
n为图像的点数。i代表图像数据，则基于吉布斯分布的CRF可被用来描述上述 
关系式＝ X…＝＾＾eXp(－巧Xi巧)，这里e(X)表示某X标签的能量，Z(i)表 
示归一化函数。 
在全连接CRF模型中，X的能量分布式由下式表述： 
ew ＝
 A)
 (3.13) ＊
 i＜J 
－元的组件表示点i被分配类别X，的反概率(或代价)。成对能量组件表示 
同时分配点i，J为标签X，，X，的代价。一元组件的值来源于FCN，FCN不考虑 
点类别分配的平滑性与连续性，成对组件提供基于图像数据的平滑规则，鼓励将 
同属性的点分配同样的类别。我们将成对组件建立成如下基于髙斯核的模型。 
知 X，) ＝ //知气)Zw(M)皆 ＞(乂，乃)
 口.14) 
历《1 
在这里对于M个，是用在特征向呈的高斯核。/表示点i的特征向量化如 
RGB颜色值或者二维坐标。函数u 0是类别适应度函数，表示成对组件的类 
别适应度矩阵。最小化CRF的能量函数e (X)得到最符合该图像的类别标记。 
由于精确的最小化上述函数是棘手的，平均场的对于CRF分布的近似方法用于 
近似最大后验概率的边际推理。这个利用简单的q(X)分布来获取精确的实际p(X) 
分布，q的能够写成独立的边际分布的形式，利用迭代算法来优化后验概率的推 
理精度。平均场推理基于髙斯空间核与高斯双边核，这些核参数通过实现人为设 
定，对于分割结果空间和表象的连续性有重要作用。 
25  
deeplAw63主要的创新点在后面的CRF部分，为了达到类似于传统CRF的 
全局优化效果，利用了循环的方法，上一次的输出为下一次的输入，其中采用的 
CRF架构是基于如1 connect CRF[66惭全局连接模型，意味着图像上所有的点对 
其他点都有或多或少的影响，具体由高斯距离核函数控制，如图3.3所示，各项 
参数由训练得到。qin为上次迭代结果，i为图像数据，u为FCN的结果，qout 
为本次迭代输出。 
u 
qin i 以
 qout－f 0 化 qin，。 
解織马雛脯马麵微与概雜合与归－化广—： ＞ 丄勺 i i i i i i 
图3.3 deepl油的单次计算过程 
如下是该计算的具体细节，下式为第一次迭代的初始概率值，由u归一化 
得到，其中u是FCN的结果，i为像素点序号，/为类别，为归一化常数，这 
个步骤相当于将u的每个像素点运用了 softmax函数，此函数在FCN中早w得 
到广泛应用，此操作不需要任何新的参数。 
qi(/) ＝去紋口剛)
 (3.巧 
式(3.16)为概率转移函数，该式表示对于某一点i的某一类别1，所有图像 
上的其他点都会对该点的有一定的转移作用，心，方)代表高斯核函数控制转 
移强度，式(3.17)为较值调整，w对应于所使用的高斯核的总体强度巧制，M 
代表使用的高斯核西数的个数。高斯核距离反映的是点与点之间关联的程度，由 
于CRF时全图相关的，也就是说高斯核的感受野是整个图像范围，这使得用蛮 
力执行高斯滤波不可行。好在perMutohedrAl lAttice技术可{＾＞1有效解决高尺度高斯 
滤波问题，使得升算复杂度只与点的数量线性相关。在误差反传时，输入节点的 
误差倒数是通过反向套用M个高斯核与输出节点的误差导数，故反向误差传播 
复杂度与正向计算一致。传统上使用高斯双边核与高斯空间核，并为了简单计算 
保持核函数的参数不变。下一步则是对于每个类别分别将M个滤波器结果加枚 
相加，每个类别都是独立的，相当于有M个输入通道1个输出通道的卷积核为 
26 
1X1的卷积操作，对于每个/都有对应的w，故相加权重有2＊/个，每个权重都 
可以训练得到。 
￣ (M) 
0＇ (/)二 Z片/M)(成方)0/(＇)
 (3.16) 
￣ (w) 
如) ＝ ！＞(＂) A (/)
 (3.17) 
如下式(3.18)和式(3.19)是两个高斯核的具体算式： 
以 ＼pi￣pJf
 …。、 eXp(－－＾＾＾ 口竭 
eXp(口.1叫 
A和A.表示i和J处的二维位置坐标向量，/，.和//表示颜色民gB向量，第 
一个式子联合考虑距离和颜色差距，距离和颜色差距越大值越小影响越小，第二 
个式子单独考虑距离差距带来的影响，距离越远值越小影响越小，三个核函数参 
数0。，，.，—般人为设定。
 、 
式(3.20)表示类别转移操作，由于不同类别变成其他类别时会有不同的兼 
容度和适应性，此时用表示一个类别变成另外类别的相容度信息矩阵，注意这里， 
表示类别相容度对类别的次序敏感，正向与反向并不相同，类别相容度矩阵由 
FCN8结果或输入的信号统计求得。u代表两种类别的相容度，在传统potts模 
型中y代表给相似性质的像素点对赋予不同的类别时带来的固定惩罚，此模型关 
键问题在于对每个类别对赋予了相同的惩罚，实际上不同类别的转移惩罚有很大 
差别。比如说，对于将人和自行车分配到相邻的点时应该具有较小的惩罚值，而 
将天空和自行车分配到相邻点应该具有较大的惩罚。所以，从样本中得到相容度 
信息比potts模型中直接人工设定一个固定值更为符合实际情况。类别转移操作 
可被视为l个输入与输出节点的而且卷积核尺度为1X1的卷积操作。 
貧w ＝
 ’启(/i)
 (3.20) 
式(3.21)代表概率整合的操作，最终概率由条件似然概率u和全局先验概 
率A(/)相减得到，u为FCN8得到的类别概率分布，此步骤不渉及任何参数，误 
差反传可以简单在输出误差上加上负号即可。式(3.2巧代表归一化操作，然后当 
做下次循环的输入。注意这里减或加无区别，依赖相容度矩阵来调节具体正负。 
27  
包(l) ＝ u爪－A(0
 (3.21) 
q，(/)＝扛Xp煩(/))
 (3.巧 左i 
deeplab的后置CRF部分采取循环计算的方式，如下公式(3.如)到式(3.25) 
所示，为了达到全局优化的结果，不断优化目标使其趋于总体优化目标，每次计 
算的结果会被下一次循环当作新的输入，通过不断调整平衡自身的条件似然概率 
和考虑到周围的先验分布信息，w达到类似于全图优化的结果。 
fsoftmax(u)，t＝ 
巧的＝
 t
 (3.23) 
扫2的＝＜＝t ＜＝t
 (3.24) 
fo，o＜＝f＜r 
＝ t
 (3.25) 
softmax主要用来在开始第一次循环时用条件似然概率u (实际上由FCN8 
得到)来初始化输入，之后按照前面的输出变下一次的输入的计算原则，t在实 
际操作中一般取5。乃表示式(3.1巧到式(3.2巧的一次迭代过程，y为最终输出并 
只在最后一次循环输出。针对图像信号带来的整体概率分布，可简单的将每个节 
点的概率分布相乘，对于最优化的类别分配，只需要计对每个节点取对应的最大 
的输出概率类别节点即可。之所可以将整体优化的CRF过程变成分离的单个 
节点优化相乘的形式，是因为每次迭代过程中每个节点就考虑了周围节点的影响， 
迭代过程就是在考虑周围点对该节点的最终影响，迭代次数越多，最终整体结果 
如式(3.26)所示，得到的值就越接近全局优化下的该点分立值。 
0的二叮公化)
 (3.26) 
3.2.2 de巧lAB模型训练 
de巧lAB之前的一些后置CRF优化方法采用梯度下降法[67潤，而de巧lAB 
的后置CRF采用的是网格优化法，只有正向操作，没有误差反向传递过程，由 
每个参数序列生成结果，将结果最好的参数取值保存下来即为后的CRF参数 
不再改变，具体方法是将所有相关参数分别设定一个范围，然后选择合适的间距 
划分网格，对所有分立值采取循环遍历的形式，选择其中对训练样本有最高的整 
体正确率值的参数设定，并保留该参数作为CRF层的固定参数。 
28 
3.3基于边缘区域变换的DT网络 
3.3.1 DT 网络 
CNN衍生的FCN等对于场景语义分割十分有效，主要任务是对图像中的每 
个点分配一个类别标签。最近对FCN的后处理操作如加上全连接CRF能有效改 
善分割精度和物体边缘信息，全连接CRF的概率转移对双边滤波器的应用是对 
边缘敏感的，对中也点距离较近化及颜色相近的转移系数较大，表示可能有相同 
类别，实际应用过程中可以使分割结果比较符合物体的实际边缘[691。 
为了进一步较好的改善边缘信息，在使用deeplab的CRF之前，应用DT 
算法pw的递归方程在图像行列的序列信号上，该递归方程对边缘敏感，所有扩 
散在边缘处停止。区域变换即DT可以看做RNN网络的特例，可以方便的表示 
为gru单元。扩散操作与边缘强度图有密切关联，在标准DT模型中边缘强度 
由颜色梯度得到，但我们将从FCN中巧层学习得到该强度值，重要的是我们可 
w从端对端的训练中得到内部边缘网络的卷积核权重，w得到样本相关的边缘滤 
波器。 
DT网络[71惭模型由h部份组成，它们首尾并接的连接在一起训练，共同优 
化最后的分割结果的精度。第一个组件基于Vgg16[721结构的FCN8得到粗略的 
分割预测的得分。第二个细件被称为内部边缘网络，该网络利用FCN8的中间层 
得到的特征，这些特征层在被堆叠么前被会填充到同样的空间尺度，一个卷积核 
为1X1尺度的只有1个输出通道的卷积层被用来作为边缘强度预测，后接上 
RELU层用来使输出在0到1的范围。第三个组件是DT网络，这是一个保留边 
缘信息的滤波器，通过分别在行和列上套用一维递归滤波器实现高效的操作。尽 
管DT传统上用作普通的图像处理，我们用它来过滤粗略的FCN分割结果得分 
使其与物体边缘结合得更好，通过内部边缘网络得到的边缘强度图。 
3.3.2边缘区域变换算法 
DT (区域变换)网络需要2个输入，粗略的待滤波输入信号X，在我们的案 
例中就是FCN8得到的初步分割结果得分，另一个是正相关的区域变换转移密度 
信号d。输出信号是滤波后信号y。对于一维的n长度信号，如式(3.27)设置义＝ 
29  
并循环i＝2，.？n计算输出信号 
义＝(1 － w，批 ＋
 (3.27) 
权重wi取决于区域变换密度4？表示为式(3.28)： 
wJ. ＝ eXp(－怎dJ / 〇■：)
 (3.28) 
〇■，代表空间区域的卷积核标准差，区域变换密度4决定了扩散范围，通过 
控制X，和前一个滤波后信号义＿1的相加比例得到当前信号乂，wJ处于0到1的范 
围，控制点i－1到i的信号传递强度，如果di十分小，我们会得到全扩散，义＝乂＿1 
以及w，.＝l。另一个极端是4的值十分大，此时w，.＝0，扩散终止，导致义＝ 
可以见到一维信号如果只沿着一个方向如从左到右，那么下个信号将只取决 
于前一信号，为解决此问题可以从左到右和从右到左来滤波两次。 
对于二维信号的区域变换，在每个信号维度用一维滤波器循序的滤波，分别 
从上到下，从下到上，从左到右，从右到左四个方向顺序滤波，之后整体进行k 
次循环来减小误差。我们减小每次循环的DT卷积核的标准差，如式(3.巧)，每 
次第k次用〇■＆代替〇■，来计算wJ。 
2＾－＊ 
口k 二。S术一二、…，k
 (3.29) 
V4＾－l 
区域变换密度4定义为式(3.30)； 
4＝1 ＋ ＆ 鱼
 (3.30) 
＆代表边缘强度，是边缘强度图的卷积核标准差，＆越大，代表点i越 
可能是一个边缘点因此扩散在此终止，通用的DT网络使用颜色梯度如式(3.31)： 
＆二至11 ▽沪 ii
 (3.31) 
亡＝1 
我们的想法是通过反向传递输出y的分割误差到两个输入，这使得我们将 
DT转化为神经网络层，我们因此可以联合训练FCN8的粗略的分割结果X和边 
缘强度g的相关参数。 
我们假定每个点乂不仅影响接下来的点义＋1，还作为一个子层的输入，因此 
反向传递时除了考虑点少41的误差反传外也接受子层的反向误差。与标准的反向 
传播类似，我们反向递归套用式(3.32)到式(3.34)，更新参数y，w， X的相 
30 
应偏导数。 
苦吟w嘴
 (3.32) 
—4＾ old (―) ＋ (—
 (3.33) dwJ dwi
 妙i 
dl …8l、 dl 
—
￣
￣ 户 〇id(：＾—) ＋ wJ
 (3.34) 
如1 如 撕 
由于权重w，在四个方向的滤波中以及k次循环中都是共享的，所以每次的 
偏导数都应该相加作为整体。用这些偏导数我们能够得到边缘强度图的偏导 
数，通过链式规则得到＆的偏导数如下式所示，l表示目标误差函数。 
w， ＝eXp(－全(1 ＋ ＆ 鱼X)
 (3.35) 
口k
 口r 
dl 來 cXg dl 
—
二


 (3.36) 
诲 口k打r 献， 
这些偏导数之后会被传入内部边缘网络，这是用来得到边缘强度预测值的。 
我们还可以建立与口控RNN[73毕元的联系，该RNN起初用来分类序列文本数据， 
此RNN有如下规则 
义＝2，夾＋(1－2，此1
 (3.37) 
该式(3.37)中，Z，.＝l－w，.，yi ＝ X，.，Z，被定义为2，＝(7(乂)，乂 是激励信号， 
以及激励函数〇■的＝ l/(l ＋ e－＇)，因此可以得到DT中边缘强度图＆和激励信号乂 
的关系如下： 
各＇＝尹思 〇g(l ＋ ＾)－l)
 (3.3 巧 
3.4本章小结 
本章主要介绍了传统的CRF计算过程和CRF的基本原理和传统方法块特征 
提取的特征描述，介绍了强度，纹理，极化矩阵特征，然后介绍了基于后接全连 
接CRF计算的原理的deep加网络，描述了全连接CRF的计算过程，最后介绍 
DT网络的原理和其基本算法，不过其具体分析和改进留在第4章说明。 
31  
4 基于FCN－hed边缘和改进DT扩散模型的内部 
与外部融合的神经网络的分割模型 
4.1 FCN－hed边缘网络 
4丄1 FCN－hed的结构 
在自然图片中检测边缘和物体边界是个前沿且具有挑战的课题，这对于图像 
处理的多个领域如图像特征，图像分割，图像检测与识别，图像跟踪与动态分析， 
医学图像检测，3d重建，等至关重要，还可以用来实现自动驾驶，提升图像语 
文解析等现阶段应用。长期的实验证实自然图片的边缘定化由视觉感知的不同层 
级决定[74][75]。一个相关的感知实验[76h正明不同物体确实有某种程度上的不同指 
弓i，与其颜色上的边界和边缘的分布无关，也就是说两者实际边界间的颜色差距 
或者特征向量差距可能很小，即梯度很小，但人眼看来可认定为强边缘，通俗 
上说，比如一个同色圆形嵌入到两者颜色人眼刚刚能分出差别的一个同色矩形的 
中间，单从计算上边缘颜色梯度很小但从全局上讲可以看成很强的内部圆形达缘， 
另一种情况是一个人身上有不同颜色的衣服和裤子但我们看来其整个人身体周 
围的边缘是最显著的，之后才会注意到某个人衣服的内部分界线，而从算术意义 
上身体周围的颜色搏度可能不如衣服和裤子或其他部位的颜色梯度大。 
图像边缘检测有着悠久的历史，分为如下几类，第一，早期的工程学算子 
SoBelp7l cAnny算子[78]，第二，基于特征的信息论方法，如pB[76]， gpB[79]，第 
三基于人工特征的机器学习的如拙l[w]，Sketch tokenS[w，结构边缘法脚等。 
除此之外，最近出现的CNN潮流强调榜征的自动提取与学习，从而产生 
deepedget831，cSCNNt843等wCNN为基础的边缘提取方法。就目前来说，结构 
迈缘法有着目前综合上最好的效果。CNN的方法也有较大提升空间。 
FCN－hed[85骑应于对应于FCN网络，五个尺度的内部层分别后接对应尺度 
的反卷积层恢复到原图大小输出五个内部边缘层，结合所有五个边缘层后接卷积 
层输出化Se层，然后每个边缘层和fuSe层采取联合优化，权重都设为1，边缘层 
和fuSe层都统一依照边缘gt图进行训练。 
为了检测边缘采用了 一个端对端的边缘检测系统，命名为整体嵌套边缘检测 
32 
网络(肥0)。依靠卷积核的权重更新，它可1＾＞1自动学习丰富的层次特征，决定该 
特征是否重要对于模拟人的视觉来解决物体边界和边缘的抽象性。 
虽然没有湿式的结构性针对边缘检测输出建模，并没有向传统方法那挣特地 
寻求计算梯度值来比较！＾＞1分辨是不是边缘，整体的意思是利用61边缘图进行图 
对图的训练与预测。嵌套的意思是强调继承和提炼内部边缘图，通过综合所有的 
边缘输出可以得到更加精确的边缘预测。这种完整的基于多层次的可学习的特征 
架构比往的多尺度方法一是特征是学习出来的而不需要人为设定特征 
提取方式，二是多层次之间存在直接联系而不是分立存在。 
hed主要着重于解决两个关键问题，1)整体的图像训练和预测，基于FCN 
网络，进行图对图的分类，输入为完整的彩色图，输出为边缘强度图。2)嵌套 
的多层次特征学习，基于FCN的多层次结构决定，将所有5个尺度的持征层都作 
为内部边缘层产生边缘，再后接一个反卷积层恢复尺度。 
一系列卷积，池化，陆lu操作 
